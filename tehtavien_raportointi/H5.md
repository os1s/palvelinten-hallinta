# Palvelinten hallinta H5

Tehtävä on tehty läppärillä josta löytyy Xubuntu 18.04 LTS

Tehtävä on osa Tero Karvisen Palvelinten hallinta -kurssia:
http://terokarvinen.com/2018/aikataulu-%E2%80%93-palvelinten-hallinta-ict4tn022-3004-ti-ja-3002-to-%E2%80%93-loppukevat-2018-5p

### Windows orjan minionin säätäminen linux masterilla
Olin jo aikaisemmassa tehtävässä kokeillut saltia windowsilla, mutta 
salt-minionin versio ei ollut sama kuin masterilla, joten ensiksi 
korjasin tämän lataamalla oikean version tästä linkistä: 
https://repo.saltstack.com/windows/Salt-Minion-2017.7.4-Py2-AMD64-Setup.exe

![alt text](https://puu.sh/C819a/4df9a98731.png "delete this")

![alt text](https://puu.sh/C82Lr/a8097c825e.png "juuh")

![alt text](https://puu.sh/C81e3/fdcb4db52c.png "jooh")

Seuraavaksi hyppäsin masterkoneelleni hyväksymään avaimen ja tekemään testipingin:
```
osku@bingobangobongo:/srv/salt$ sudo salt-key -A
The following keys are going to be accepted:
Unaccepted Keys:
windowsosku
Proceed? [n/Y] y
Key for minion windowsosku accepted.
osku@bingobangobongo:/srv/salt$ sudo salt '*' test.ping
windowsosku:
    True
```

Kaikki näyttää toimivan hyvin ainakin tähän mennessä. 
Seuraavaksi tehdään pari taikaa, että voimme asentaa ohjelmia windows-orjalle:
```
osku@bingobangobongo:/srv/salt$ sudo mkdir win
osku@bingobangobongo:/srv/salt$ sudo chown root.salt win
osku@bingobangobongo:/srv/salt$ sudo chmod ug+rwx win
osku@bingobangobongo:/srv/salt$ sudo salt-run winrepo.update_git_repos
https://github.com/saltstack/salt-winrepo-ng.git:
    /srv/salt/win/repo-ng/salt-winrepo-ng
https://github.com/saltstack/salt-winrepo.git:
    /srv/salt/win/repo/salt-winrepo
osku@bingobangobongo:/srv/salt$ sudo salt -G 'os:windows' pkg.refresh_db
windowsosku:
    ----------
    failed:
        0
    success:
        260
    total:
        260
```

Tämän jälkeen tehdään yksinkertainen moduli, jonka tarkoituksena on asentaa firefox-selain:
```
osku@bingobangobongo:/srv/salt/tulikettu$ cat init.sls 
packages:
  pkg.installed:
    - pkgs:
      - firefox
```

Kokeillaan ajaa moduli:
```
osku@bingobangobongo:/srv/salt/tulikettu$ sudo salt '*' state.apply tulikettu
windowsosku:
----------
          ID: packages
    Function: pkg.installed
      Result: True
     Comment: The following packages were installed/updated: firefox
     Started: 19:08:25.193284
    Duration: 27055.844 ms
     Changes:   
              ----------
              Mozilla Maintenance Service:
                  ----------
                  new:
                      63.0
                  old:
              firefox:
                  ----------
                  new:
                      63.0
                  old:

Summary for windowsosku
------------
Succeeded: 1 (changed=1)
Failed:    0
------------
Total states run:     1
Total run time:  27.056 s
```

Hypätään vielä windowskoneelle tarkistamaan, että firefox todellakin asentui:
![alt text](https://puu.sh/C83fv/c842d14a91.png "auttakaa heti")

Jee.
### Windowsin säätäminen saltilla ilman herra-orja rakennetta

### Windows ohjelmien säätäminen saltilla

### Lähteet
http://terokarvinen.com/2018/aikataulu-%E2%80%93-palvelinten-hallinta-ict4tn022-3004-ti-ja-3002-to-%E2%80%93-loppukevat-2018-5p
### Tietoa
Tätä dokumenttia saa kopioida ja muokata GNU General Public License 
(versio 2 tai uudempi) mukaisesti.http://www.gnu.org/licenses/gpl.html
